# syntax=docker.io/docker/dockerfile:1
# vim:set ft=dockerfile:

FROM ghcr.io/quakeservices/base:latest


RUN poetry export --format=requirements.txt \
                  --without-hashes \
                  --with main,master \
  | pip install -r /dev/stdin

WORKDIR /opt/quakeservices

COPY master /opt/quakeservices/master
COPY qs.py /opt/quakeservices

CMD [ "/opt/quakeservices/qs.py", \
      "--log-level", "debug", \
      "--hide-boto-logs", \
      "server", \
      "run"]
