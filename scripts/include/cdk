#!/usr/bin/env bash
set -euo pipefail

cd "$(git rev-parse --show-toplevel)" || exit 1

source scripts/include/build-env
scripts/build-cdk > /dev/null

$CONTAINER_COMMAND run --interactive \
           --tty \
           --rm \
           --env AWS_ACCESS_KEY_ID \
           --env AWS_SECRET_ACCESS_KEY \
           --env AWS_ACCOUNT \
           --env AWS_SECURITY_TOKEN \
           --env AWS_DEFAULT_REGION \
           "$MOUNT_SOCKET" \
           "$MOUNT_PWD" \
           --workdir "$(pwd)" \
           "${APP_NAME}/cdk:latest" \
           "$@"
